<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>jules_exam_solution_marimo.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>jules exam solution marimo</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/index-Bby4ubuq.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/preload-helper-BnutJmlU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/react-cj45iF1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/compiler-runtime-bbSa6V1W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/jsx-runtime-DmpivWpf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useEventListener-DVwjxFkt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/react-dom-BjyRIiB0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Combination-ChP9ffHH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/clsx-BlAkgCmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cn-BaXqCYqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/menu-items-DwJgssBv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/hotkeys-jCLisiwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/button-DCB7VoVL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CLwJsV2W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/createLucideIcon-DbfgBYhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/check-DqnGmZZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/select-BkT3QHmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/multi-map-DOgPLTwj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/chevron-right-Bu29x-gp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dropdown-menu-CN5aVh8R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/tooltip-fQCr9gxe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseIsEqual-CVFfFJm2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/jotai-C7U7c6dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/invariant-D5a0EE05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/merge-Dvc5opZF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/utils-GFT-p9ER.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/requests-CftYh9v2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/once-C5bmD4W5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toDate-CbcWqY6f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseSlice-BWZ0PeaJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_hasUnicode-3DIK_jNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/upperFirst-CBQfDRod.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/capitalize-CBqvgOfA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ai-model-dropdown-6fVxZc7s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/badge-Dlbidp5Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/use-toast-BBrPeu2N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/constants-CEISdYm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Deferred-NfAvvkGM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/config-CULm_ZjE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/uuid-D0hUC3Qw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/key-CaC9xuXQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/connection-DOETP_K0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useLifecycle-DiLWmtpP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useNonce-DJX1XgWY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/capabilities-MLRWIHmO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/createReducer-CTvsuJZY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-C6GW8SWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-0FJpM7wG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BFSjfL-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BrS3KFEl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-DvTgOH5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CZkQ2hcE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-DrAMGx2E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-YP2XXp1Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CvIoRIOp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/stex-xveX5l_T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cjs-Ck8KMDI1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseProperty-c4IQJQis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/now-BXqTLlmI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/debounce-BUM2losY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/type-CnQq0uaD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/marked.esm-BV7g2d65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/main-ChjX94eX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cells-D2eha_-B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/kbd-f3Vl6KVv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/renderShortcut-WvNIumsP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useEvent-2G6_06QI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useDeleteCell-BBvlHSmp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/lazy-DGC5ohlw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/defaultLocale-CNK_a8Z2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/precisionRound-B2LwJfpR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/defaultLocale-Mn032I1s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/vega-loader.browser-BVwjVCQc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/tooltip-CJwdMp1K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ErrorBoundary-Bu1xrDr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/alert-dialog-81myxzgR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dialog-B0ZQRYmN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useDebounce-88MnHfxr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/numbers-Da0UyJ4q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/SSRProvider-BufkqsXB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/context-CmoHMC3k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useNumberFormatter-BCRD3Xiy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/usePress-BJP5uSM9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/input-BYmR6HBp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ImperativeModal-wjVZ4eQS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cell-link-C_YhUpui.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/alert-Uyjokbhs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/links-L8RfsBvj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/state-HLf_9r-5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/MarimoErrorOutput-CAtwsmR1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/spinner-DXjgT_d6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_arrayReduce-DV4IVFuG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/startCase-RfubwhHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/strings-DoNzvBC8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/command-hjwnCrLr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/popover-y-4eU0xo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useRunCells-DyCvt_J0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/copy-CvoiXuJX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/copy-4VJP-N0g.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/copy-icon-DNw8yyV3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mode-BvhOdC_B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/purify.es-Cz-BfAJO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/RenderHTML-BPePlDKV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/table-D7dxF_z5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/tabs-DmZtZQ_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useAsyncData-CXeJJDVW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useIframeCapabilities-CE7UrR0d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/error-banner-C8bnn_Oj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/formats-B6WeWt9C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useTheme-C1t46HlN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/en-US-D9Lph-mE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/isValid-CJoeYwPo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/maps-BGCWjJqb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/shim-CL-N1TlJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/download-3twj9Xwh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/extends-BUnZS06R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/emotion-is-prop-valid.esm-jr96H-64.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useDateFormatter-Bt93nQ51.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/range-ZclXTdAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/table-CTK995oK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Output-nN1GOw3k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/name-cell-input-DFksRedA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useHotkey-DWz-THL8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-ByBamzbc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BqQuenSr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CA2lBgvV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CdeBdpnu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-DLJRvE7V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BYOmBsk_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-DyBtC3F_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BWGrOCqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CUrxoONf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-CdaKSxCx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BTy2AO2F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-Bf-v2eRP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-BMjSE6I1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/apl-BbjuiDsS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/asciiarmor-DTXJDFvM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/asn1-By269rpU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/brainfuck-Bcb3sDkN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/clike-D4Hc6kDf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/clojure-Di966kl0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cmake-EdqYjU-h.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cobol-CfB_KfUl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/coffeescript-CZnv20P1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/commonlisp-B_wA9NNL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/crystal-B5VE-DHo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/css-CikpO4hp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cypher-DAN695K7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/d-Cp2O9KNQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/diff-CaYK6FdG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dtd-CKpjjiwC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dylan-BwFScnVi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ecl-DRplsGLw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/eiffel-Uz6uj6V8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/elm-W_885aoq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/erlang-Dm0JOfW3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/simple-mode-H9lcpICo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/factor-Cv1PFcda.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/forth-B_l0qIWF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/fortran-CLxZdPOJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/gas-CWKXfdKr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/gherkin-DlSGfHGe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/groovy-CgF94U6E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/haskell-D8PgguQh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/haxe-GK8_kbF8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/idl-Q7A7KWLA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/javascript-CyIGUINn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/julia-CQO0ko_c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/livescript-CmgdKnEH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/lua-mT6czOLr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mathematica-yr8Kagso.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mbox-DwCdX69t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mirc-D24moCA0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mllike-1RsOiz7E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/modelica-Bmw70I7C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mscgen-Dvk53jZ9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/mumps-CuBXsA1c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/nsis-P2ivpou9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ntriples-CFrQmJZ8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/octave-BE_1B5hT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/oz-B8qIV9R9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/pascal-Dm4iZfnp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/perl-DuC7Sc1M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/pig-Dj3wv73m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/powershell-CJYdAA3Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/properties-CPd1j9nt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/protobuf-BD6S47qV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/pug-BEDx7tiF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/puppet-BRGJzdBr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/python--KWNfsxx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/q-KhF-lSPY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/r-Casg9NL_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/rpm-CLm8BZN9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ruby-kjKq0O38.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/sas-CNUs9bYJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/scheme-H3s5l6ia.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/shell-YvTPydQ4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/sieve-609IkA1k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/smalltalk-D3NOidyD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/sparql-CC3YRBhS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/stylus-DanbRWv8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/swift-qtGHoPyl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/tcl-0XlfOish.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/textile-BsUNa0ba.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toml-BkvbWdmE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/troff-BM7wyERf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ttcn-cfg-6rqcHSj6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ttcn-In-Os3qL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/turtle-N2LAl97c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/vb-CHmuFJt3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/vbscript-DwRleoLn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/velocity-DK0DZeo3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/verilog-n25-NWOh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/vhdl-DJ2vn3A6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/webidl-BsEgPfe4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/xquery-Cn6JUpeM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/yacas-ZFTwhpzI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/z80-Ct8aYSc-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/esm-BwqUR0TG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/objectWithoutPropertiesLoose-DuRO3TFS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/esm-DWtLTXrW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/trash-mOekSI_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ConsoleOutput-Dv7htISD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/icons-DNkkeQqC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/add-missing-import-CMKdLyLj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/blob-ISoY06EG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/add-cell-with-ai-B-hltL9V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/chart-no-axes-column-C14EHesU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/square-function-zb2K8NSn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/spec-CBVnxwfI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/focus-DkcYPAN0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useInstallPackage-CQfcI_AS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/column-preview-DNqIAgxs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useAddCell-f9BZ2_7O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/toggle-D182En97.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/api-DvkfrUs5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/globals-BbFlbqp7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/share-KKyHVEcH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/dist-B5o2gLy7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/memoize-DhF8x4Aa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_toKey-16owuO_q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseSet-L2qemYhz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/utilities.esm-Bmk5DH-t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/floating-outline-DRYzI4KS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/eye-off-B1gsplPc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/plus-DVSnLdy5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/readonly-python-code-Dr2-5Hjq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/file-video-camera-BakM8DrE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/file-text-br2BVDBF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/file-D9scEdAT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/types-m5vJOc8S.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/label-DoQ8dPQj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/form-C4OqdpTP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/textarea-DxQAjCBZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/circle-x-65ujNh_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/refresh-ccw-DFz7B_fr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/trash-2-YwvEZLT8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/form-CYnSp8Xw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/field-LInelSvU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/switch-CNBsJN9T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useBoolean-D47R73oR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/useDeepCompareMemoize-CGfWpvqN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/LazyAnyLanguageCodeMirror-BmYv6_Y6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/types-PohSL97i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/prop-types-CElKCMhv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/es-IayDfy8U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/VisuallyHidden-fFcUDWss.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_baseFlatten-ViL-mfkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/get-BUGWIXZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/hasIn-BgJKauE7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/_basePickBy-CSDa7ReR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/pick-BQzWKfma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/square-C2sucLEB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/code-xml-tuXFIdrH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/download-BYnrx3yk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/globe-CocuQrDy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/send-Cda8V3YD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/refresh-cw-CFk1MA73.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/settings-DukM6PkA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/triangle-alert-BBtcXh_3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/bundle.esm-DtrWSlr6.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/Output-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.0/dist/assets/index-DWYaH39W.css">

<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "jules_exam_solution_marimo.py",
            "mode": "read",
            "version": "0.18.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "compact"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import QuantLib as ql\nimport numpy as np\nimport pandas as pd\nimport datetime as dt\nimport sympy as sp\nimport plotly.graph_objects as go\nimport plotly.express as px\nfrom scipy.optimize import minimize\nimport credit_market_tools as cmt\nimport matplotlib.pyplot as plt", "code_hash": "e57e6fef0a0ca8787a85dcb8e238ea9a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "__"}, {"code": "# Setup calculation date\ncalc_date = ql.Date(3, 5, 2024)\nql.Settings.instance().evaluationDate = calc_date\nas_of_date = pd.to_datetime('2024-05-03')", "code_hash": "d252cd44b7436774ca2d965ad928f091", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "__"}, {"code": "# Override problematic functions from credit_market_tools.py\ndef create_bonds_and_weights_fixed(bond_details, tsy_yield_curve_handle):\n    risk_free_bond_engine = ql.DiscountingBondEngine(tsy_yield_curve_handle)\n    fixed_rate_bond_objects = []\n    bond_market_prices = []    \n    bond_yields = []\n    bond_DV01s = []    \n    bond_durations = []    \n    valid_indices = []\n\n    for index, row in bond_details.iterrows():\n        fixed_rate_bond = cmt.create_bond_from_symbology(row)\n        fixed_rate_bond.setPricingEngine(risk_free_bond_engine)\n        bond_price = row['midPrice']\n\n        try:\n            p = float(bond_price)\n            try:\n                bond_yield = fixed_rate_bond.bondYield(p, ql.Thirty360(ql.Thirty360.USA), ql.Compounded, ql.Semiannual) * 100\n            except Exception:\n                bond_yield = 5.0 \n\n            bond_yield_rate = ql.InterestRate(bond_yield/100, ql.ActualActual(ql.ActualActual.ISMA), ql.Compounded, ql.Semiannual)\n            bond_duration = ql.BondFunctions.duration(fixed_rate_bond, bond_yield_rate)\n            accrued = fixed_rate_bond.accruedAmount()\n            dirty_price_val = p + accrued\n            bond_mod_duration = ql.BondFunctions.duration(fixed_rate_bond, bond_yield_rate, ql.Duration.Modified)\n            bond_DV01 = dirty_price_val * bond_mod_duration * 0.0001\n\n            fixed_rate_bond_objects.append(fixed_rate_bond)\n            bond_market_prices.append(bond_price)\n            bond_yields.append(bond_yield)\n            bond_DV01s.append(bond_DV01)\n            bond_durations.append(bond_duration)\n            valid_indices.append(index)\n        except Exception as e:\n            continue\n\n    calib_weights = [1 / d if d != 0 else 0 for d in bond_DV01s]\n    if not calib_weights:\n        return [], [], [], [], [], [], []\n    sum_calib_weights = sum(calib_weights)\n    if sum_calib_weights == 0:\n         calib_weights = [1.0/len(calib_weights)] * len(calib_weights)\n    else:\n         calib_weights = [x / sum_calib_weights for x in calib_weights]\n    return(fixed_rate_bond_objects, calib_weights, bond_market_prices, bond_yields, bond_DV01s, bond_durations, valid_indices)\n\ndef calculate_nelson_siegel_model_prices_and_yields_fixed(nelson_siegel_params, calc_date, fixed_rate_bond_objects, tsy_yield_curve_handle, bond_recovery_rate = 0.4):\n    nelson_siegel_surv_prob_curve_handle = cmt.create_nelson_siegel_curve(calc_date, nelson_siegel_params)\n    nelson_siegel_risky_bond_engine = ql.RiskyBondEngine(nelson_siegel_surv_prob_curve_handle, bond_recovery_rate, tsy_yield_curve_handle)\n    bond_model_prices = []\n    bond_model_yields = []\n    for fixed_rate_bond in fixed_rate_bond_objects:\n        fixed_rate_bond.setPricingEngine(nelson_siegel_risky_bond_engine)\n        bond_price = 0.0\n        bond_yield = 0.0\n        try:\n            bond_price = fixed_rate_bond.cleanPrice()\n        except Exception:\n            bond_price = 0.0\n        if bond_price \u003E 0:\n            try:\n                bond_yield = fixed_rate_bond.bondYield(bond_price, ql.Thirty360(ql.Thirty360.USA), ql.Compounded, ql.Semiannual) * 100\n            except Exception:\n                bond_yield = 0.0\n        bond_model_prices.append(bond_price)\n        bond_model_yields.append(bond_yield)\n    return(bond_model_prices, bond_model_yields)\n\ndef nelson_siegel_sse_fixed(nelson_siegel_params, calc_date, fixed_rate_bond_objects, market_prices, calib_weights, tsy_yield_curve_handle, bond_recovery_rate = 0.4):\n    bond_model_prices, bond_model_yields = calculate_nelson_siegel_model_prices_and_yields_fixed(nelson_siegel_params, calc_date, fixed_rate_bond_objects, tsy_yield_curve_handle, bond_recovery_rate)\n    sse = 0\n    for i in range(len(market_prices)):\n        if bond_model_prices[i] \u003C= 0.01: \n             model_error = 100.0\n        else:\n             model_error = market_prices[i] - bond_model_prices[i]                \n        sse += model_error * model_error * calib_weights[i]                        \n    return(sse) \n\ndef calibrate_nelson_siegel_model_fixed(initial_nelson_siegel_params, calc_date, bond_details, tsy_yield_curve_handle, bond_recovery_rate = 0.4):\n    fixed_rate_bond_objects, calib_weights, bond_market_prices, bond_yields, bond_DV01s, bond_durations, valid_indices = create_bonds_and_weights_fixed(bond_details, tsy_yield_curve_handle)\n    if not fixed_rate_bond_objects:\n        raise ValueError(\"No valid bonds for calibration\")\n    param_bounds = [(1e-3, 0.1), (-0.1, 0.1), (-0.1, 0.1), (1e-3, 10)]\n    calib_results = cmt.minimize(nelson_siegel_sse_fixed, initial_nelson_siegel_params, args = (calc_date, fixed_rate_bond_objects, bond_market_prices, calib_weights, tsy_yield_curve_handle, bond_recovery_rate), bounds = param_bounds)\n    return calib_results, valid_indices\n\ndef calibrate_yield_curve_from_frame_stable(calc_date, treasury_details, price_quote_column):\n    ql.Settings.instance().evaluationDate = calc_date\n    sorted_details_frame = treasury_details.sort_values(by='maturity')    \n    day_count = ql.ActualActual(ql.ActualActual.ISMA)\n    bond_helpers = []\n    for index, row in sorted_details_frame.iterrows():\n        bond_object = cmt.create_bond_from_symbology(row)\n        tsy_clean_price_quote = row[price_quote_column]\n        tsy_clean_price_handle = ql.QuoteHandle(ql.SimpleQuote(tsy_clean_price_quote))\n        bond_helper = ql.BondHelper(tsy_clean_price_handle, bond_object)\n        bond_helpers.append(bond_helper)\n    yield_curve = ql.PiecewiseFlatForward(calc_date, bond_helpers, day_count)\n    yield_curve.enableExtrapolation()\n    return yield_curve", "code_hash": "2faf57b5957e29f048f95e16f460112c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "__"}, {"code": "# --- Problem 2 ---\nbond_symbology = pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam/data/bond_symbology.xlsx')\nbond_market_prices_eod = pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam/data/bond_market_prices_eod.xlsx')\nbond_market_prices_eod['midPrice'] = (bond_market_prices_eod['bidPrice'] + bond_market_prices_eod['askPrice']) / 2\nbond_market_prices_eod['midYield'] = (bond_market_prices_eod['bidYield'] + bond_market_prices_eod['askYield']) / 2\n\naapl_row = bond_symbology[bond_symbology['isin'] == 'US037833AT77'].iloc[0]\naapl_bond = cmt.create_bond_from_symbology(aapl_row)\naapl_cashflows = cmt.get_bond_cashflows(aapl_bond, calc_date)\n\naapl_market = bond_market_prices_eod[bond_market_prices_eod['isin'] == 'US037833AT77'].iloc[0]\naapl_yield = aapl_market['midYield']\ny = aapl_yield / 100.0\n\nflat_rate = ql.SimpleQuote(y)\nrate_handle = ql.QuoteHandle(flat_rate)\nday_count = ql.Thirty360(ql.Thirty360.USA)\ncompounding = ql.Compounded\nfrequency = ql.Semiannual\n\nyield_ts = ql.FlatForward(calc_date, rate_handle, day_count, compounding, frequency)\nengine = ql.DiscountingBondEngine(ql.YieldTermStructureHandle(yield_ts))\naapl_bond.setPricingEngine(engine)\n\nprice = aapl_bond.cleanPrice()\ninterest_rate = ql.InterestRate(y, day_count, compounding, frequency)\nmod_duration = ql.BondFunctions.duration(aapl_bond, interest_rate, ql.Duration.Modified)\nconvexity = ql.BondFunctions.convexity(aapl_bond, interest_rate)\ndv01 = mod_duration * price * 0.0001", "code_hash": "4e63edba6e16d877a75561cf2323eb8d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "__"}, {"code": "# --- Problem 3 ---\nsofr_symbology = pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam/data/sofr_swaps_symbology.xlsx')\nsofr_market = pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam/data/sofr_swaps_market_data_eod.xlsx')\nsofr_df = pd.merge(sofr_market, sofr_symbology, on='figi').drop_duplicates(subset=['tenor'])\nsofr_curve = cmt.calibrate_sofr_curve_from_frame(calc_date, sofr_df, 'midRate')\nsofr_handle = ql.YieldTermStructureHandle(sofr_curve)\n\ncds_market = pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam/data/cds_market_data_eod.xlsx')\nford_cds_row = cds_market[cds_market['ticker'] == 'F'].iloc[0]\ntenors_yrs = [1, 2, 3, 5, 7, 10]\nford_spreads = [ford_cds_row[f'par_spread_{t}y'] for t in tenors_yrs]\n\nford_hazard_curve = cmt.calibrate_cds_hazard_rate_curve(calc_date, sofr_handle, ford_spreads)\nford_hazard_handle = ql.DefaultProbabilityTermStructureHandle(ford_hazard_curve)\n\ncds_coupon = 100.0 / 10000.0\ncds_maturity = ql.Date(20, 6, 2029)\nnotional = 10000000.0\nside = ql.Protection.Buyer\nschedule = ql.MakeSchedule(effectiveDate=calc_date, terminationDate=cds_maturity, tenor=ql.Period(3, ql.Months), calendar=ql.UnitedStates(ql.UnitedStates.GovernmentBond), convention=ql.Following, terminalDateConvention=ql.Unadjusted, rule=ql.DateGeneration.TwentiethIMM, endOfMonth=False)\ncds_obj = ql.CreditDefaultSwap(side, notional, cds_coupon, schedule, ql.Following, ql.Actual360())\ncds_engine = ql.MidPointCdsEngine(ford_hazard_handle, 0.4, sofr_handle)\ncds_obj.setPricingEngine(cds_engine)\n\ncds_pv = cds_obj.NPV()", "code_hash": "f3e0240c1b61aee2e503bd224353f236", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "__"}, {"code": "# --- Problem 5 ---\nlqd_comp = pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam/data/lqd_basket_composition.xlsx')\nlqd_symb = pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam/data/lqd_corp_symbology.xlsx')\nlqd_merged = pd.merge(lqd_comp, lqd_symb, on='isin', how='left')\n\nbond_dv01s = []\nbasket_dv01s = []\n\nfor idx, row in lqd_merged.iterrows():\n    try:\n        bond = cmt.create_bond_from_symbology(row)\n        y_5 = row['yield'] / 100.0\n        dc = bond.dayCounter()\n        ir = ql.InterestRate(y_5, dc, ql.Compounded, ql.Semiannual)\n        price_5 = bond.cleanPrice(y_5, dc, ql.Compounded, ql.Semiannual, calc_date)\n        mod_dur = ql.BondFunctions.duration(bond, ir, ql.Duration.Modified, calc_date)\n        b_dv01 = price_5 * mod_dur * 0.0001\n        basket_dv01 = b_dv01 * row['face_notional'] / 100.0\n        bond_dv01s.append(b_dv01)\n        basket_dv01s.append(basket_dv01)\n    except:\n        bond_dv01s.append(0)\n        basket_dv01s.append(0)\n\nlqd_merged['bond_DV01'] = bond_dv01s\nlqd_merged['basket_DV01'] = basket_dv01s", "code_hash": "41e41ca41ed4fd95eeb6270dffd11f30", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "__"}, {"code": "# --- Problem 6 ---\ngovt_symb = pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam/data/govt_on_the_run.xlsx')\ngovt_symb_full = pd.merge(govt_symb[['isin']], bond_symbology, on='isin', how='left')\ngovt_merged = pd.merge(govt_symb_full, bond_market_prices_eod[['isin', 'midPrice']], on='isin')\ntsy_curve = calibrate_yield_curve_from_frame_stable(calc_date, govt_merged, 'midPrice')\ntsy_handle = ql.YieldTermStructureHandle(tsy_curve)\n\nfull_universe = pd.merge(bond_symbology, bond_market_prices_eod, on='isin')\nif 'ticker_x' in full_universe.columns:\n    full_universe.rename(columns={'ticker_x': 'ticker'}, inplace=True)\n\norcl_bonds = full_universe[\n    (full_universe['ticker'] == 'ORCL') \u0026 \n    (full_universe['cpn_type'] == 'FIXED') \u0026 \n    (full_universe['amt_out'] \u003E 100)\n].copy()\n\nif 'class_x' in orcl_bonds.columns:\n    orcl_bonds.rename(columns={'class_x': 'class'}, inplace=True)\n\nfor col in ['days_settle', 'coupon', 'start_date', 'maturity', 'acc_first', 'cpn_freq']:\n    if f'{col}_x' in orcl_bonds.columns:\n        orcl_bonds.rename(columns={f'{col}_x': col}, inplace=True)\n\norcl_bonds['maturity_dt'] = pd.to_datetime(orcl_bonds['maturity'])\norcl_bonds['TTM'] = (orcl_bonds['maturity_dt'] - as_of_date).dt.days / 365.25\norcl_bonds.sort_values('TTM', inplace=True)\n\ninit_params = [0.01, 0.01, 0.01, 1.0]\ntry:\n    res, valid_indices = calibrate_nelson_siegel_model_fixed(init_params, calc_date, orcl_bonds, tsy_handle)\n    opt_params = res.x\n\n    orcl_bonds_valid = orcl_bonds.loc[valid_indices].copy()\n    fixed_bonds, weights, mkt_prices, mkt_yields, dv01s, durs, _ = create_bonds_and_weights_fixed(orcl_bonds_valid, tsy_handle)\n    mod_prices, mod_yields = calculate_nelson_siegel_model_prices_and_yields_fixed(opt_params, calc_date, fixed_bonds, tsy_handle)\n\n    orcl_bonds_valid['modelPrice'] = mod_prices\n    orcl_bonds_valid['modelYield'] = mod_yields\n\n    print(\"NS Calibrated\")\nexcept Exception as e:\n    print(f\"NS Calibration Error: {e}\")", "code_hash": "e7eb0ca0fdb6db4e54e64b5755ec79ec", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "__"}], "metadata": {"marimo_version": "0.18.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "e57e6fef0a0ca8787a85dcb8e238ea9a", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d252cd44b7436774ca2d965ad928f091", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "2faf57b5957e29f048f95e16f460112c", "console": [], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "4e63edba6e16d877a75561cf2323eb8d", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "f3e0240c1b61aee2e503bd224353f236", "console": [], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "41e41ca41ed4fd95eeb6270dffd11f30", "console": [], "id": "PKri", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "e7eb0ca0fdb6db4e54e64b5755ec79ec", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "NS Calibrated\n", "type": "stream"}], "id": "Xref", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.18.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>

<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.18.0%22%0Aapp%20%3D%20marimo.App()%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20QuantLib%20as%20ql%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20datetime%20as%20dt%0A%20%20%20%20import%20sympy%20as%20sp%0A%20%20%20%20import%20plotly.graph_objects%20as%20go%0A%20%20%20%20import%20plotly.express%20as%20px%0A%20%20%20%20from%20scipy.optimize%20import%20minimize%0A%20%20%20%20import%20credit_market_tools%20as%20cmt%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20return%20cmt%2C%20pd%2C%20ql%0A%0A%0A%40app.cell%0Adef%20_(pd%2C%20ql)%3A%0A%20%20%20%20%23%20Setup%20calculation%20date%0A%20%20%20%20calc_date%20%3D%20ql.Date(3%2C%205%2C%202024)%0A%20%20%20%20ql.Settings.instance().evaluationDate%20%3D%20calc_date%0A%20%20%20%20as_of_date%20%3D%20pd.to_datetime('2024-05-03')%0A%20%20%20%20return%20as_of_date%2C%20calc_date%0A%0A%0A%40app.cell%0Adef%20_(cmt%2C%20ql)%3A%0A%20%20%20%20%23%20Override%20problematic%20functions%20from%20credit_market_tools.py%0A%20%20%20%20def%20create_bonds_and_weights_fixed(bond_details%2C%20tsy_yield_curve_handle)%3A%0A%20%20%20%20%20%20%20%20risk_free_bond_engine%20%3D%20ql.DiscountingBondEngine(tsy_yield_curve_handle)%0A%20%20%20%20%20%20%20%20fixed_rate_bond_objects%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20bond_market_prices%20%3D%20%5B%5D%20%20%20%20%0A%20%20%20%20%20%20%20%20bond_yields%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20bond_DV01s%20%3D%20%5B%5D%20%20%20%20%0A%20%20%20%20%20%20%20%20bond_durations%20%3D%20%5B%5D%20%20%20%20%0A%20%20%20%20%20%20%20%20valid_indices%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20for%20index%2C%20row%20in%20bond_details.iterrows()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20fixed_rate_bond%20%3D%20cmt.create_bond_from_symbology(row)%0A%20%20%20%20%20%20%20%20%20%20%20%20fixed_rate_bond.setPricingEngine(risk_free_bond_engine)%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_price%20%3D%20row%5B'midPrice'%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20p%20%3D%20float(bond_price)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_yield%20%3D%20fixed_rate_bond.bondYield(p%2C%20ql.Thirty360(ql.Thirty360.USA)%2C%20ql.Compounded%2C%20ql.Semiannual)%20*%20100%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_yield%20%3D%205.0%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_yield_rate%20%3D%20ql.InterestRate(bond_yield%2F100%2C%20ql.ActualActual(ql.ActualActual.ISMA)%2C%20ql.Compounded%2C%20ql.Semiannual)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_duration%20%3D%20ql.BondFunctions.duration(fixed_rate_bond%2C%20bond_yield_rate)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20accrued%20%3D%20fixed_rate_bond.accruedAmount()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dirty_price_val%20%3D%20p%20%2B%20accrued%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_mod_duration%20%3D%20ql.BondFunctions.duration(fixed_rate_bond%2C%20bond_yield_rate%2C%20ql.Duration.Modified)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_DV01%20%3D%20dirty_price_val%20*%20bond_mod_duration%20*%200.0001%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fixed_rate_bond_objects.append(fixed_rate_bond)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_market_prices.append(bond_price)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_yields.append(bond_yield)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_DV01s.append(bond_DV01)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_durations.append(bond_duration)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20valid_indices.append(index)%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20calib_weights%20%3D%20%5B1%20%2F%20d%20if%20d%20!%3D%200%20else%200%20for%20d%20in%20bond_DV01s%5D%0A%20%20%20%20%20%20%20%20if%20not%20calib_weights%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%5B%5D%2C%20%5B%5D%2C%20%5B%5D%2C%20%5B%5D%2C%20%5B%5D%2C%20%5B%5D%2C%20%5B%5D%0A%20%20%20%20%20%20%20%20sum_calib_weights%20%3D%20sum(calib_weights)%0A%20%20%20%20%20%20%20%20if%20sum_calib_weights%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20calib_weights%20%3D%20%5B1.0%2Flen(calib_weights)%5D%20*%20len(calib_weights)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20calib_weights%20%3D%20%5Bx%20%2F%20sum_calib_weights%20for%20x%20in%20calib_weights%5D%0A%20%20%20%20%20%20%20%20return(fixed_rate_bond_objects%2C%20calib_weights%2C%20bond_market_prices%2C%20bond_yields%2C%20bond_DV01s%2C%20bond_durations%2C%20valid_indices)%0A%0A%20%20%20%20def%20calculate_nelson_siegel_model_prices_and_yields_fixed(nelson_siegel_params%2C%20calc_date%2C%20fixed_rate_bond_objects%2C%20tsy_yield_curve_handle%2C%20bond_recovery_rate%20%3D%200.4)%3A%0A%20%20%20%20%20%20%20%20nelson_siegel_surv_prob_curve_handle%20%3D%20cmt.create_nelson_siegel_curve(calc_date%2C%20nelson_siegel_params)%0A%20%20%20%20%20%20%20%20nelson_siegel_risky_bond_engine%20%3D%20ql.RiskyBondEngine(nelson_siegel_surv_prob_curve_handle%2C%20bond_recovery_rate%2C%20tsy_yield_curve_handle)%0A%20%20%20%20%20%20%20%20bond_model_prices%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20bond_model_yields%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20fixed_rate_bond%20in%20fixed_rate_bond_objects%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20fixed_rate_bond.setPricingEngine(nelson_siegel_risky_bond_engine)%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_price%20%3D%200.0%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_yield%20%3D%200.0%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_price%20%3D%20fixed_rate_bond.cleanPrice()%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_price%20%3D%200.0%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20bond_price%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_yield%20%3D%20fixed_rate_bond.bondYield(bond_price%2C%20ql.Thirty360(ql.Thirty360.USA)%2C%20ql.Compounded%2C%20ql.Semiannual)%20*%20100%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bond_yield%20%3D%200.0%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_model_prices.append(bond_price)%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_model_yields.append(bond_yield)%0A%20%20%20%20%20%20%20%20return(bond_model_prices%2C%20bond_model_yields)%0A%0A%20%20%20%20def%20nelson_siegel_sse_fixed(nelson_siegel_params%2C%20calc_date%2C%20fixed_rate_bond_objects%2C%20market_prices%2C%20calib_weights%2C%20tsy_yield_curve_handle%2C%20bond_recovery_rate%20%3D%200.4)%3A%0A%20%20%20%20%20%20%20%20bond_model_prices%2C%20bond_model_yields%20%3D%20calculate_nelson_siegel_model_prices_and_yields_fixed(nelson_siegel_params%2C%20calc_date%2C%20fixed_rate_bond_objects%2C%20tsy_yield_curve_handle%2C%20bond_recovery_rate)%0A%20%20%20%20%20%20%20%20sse%20%3D%200%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(len(market_prices))%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20bond_model_prices%5Bi%5D%20%3C%3D%200.01%3A%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20model_error%20%3D%20100.0%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20model_error%20%3D%20market_prices%5Bi%5D%20-%20bond_model_prices%5Bi%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20sse%20%2B%3D%20model_error%20*%20model_error%20*%20calib_weights%5Bi%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20return(sse)%20%0A%0A%20%20%20%20def%20calibrate_nelson_siegel_model_fixed(initial_nelson_siegel_params%2C%20calc_date%2C%20bond_details%2C%20tsy_yield_curve_handle%2C%20bond_recovery_rate%20%3D%200.4)%3A%0A%20%20%20%20%20%20%20%20fixed_rate_bond_objects%2C%20calib_weights%2C%20bond_market_prices%2C%20bond_yields%2C%20bond_DV01s%2C%20bond_durations%2C%20valid_indices%20%3D%20create_bonds_and_weights_fixed(bond_details%2C%20tsy_yield_curve_handle)%0A%20%20%20%20%20%20%20%20if%20not%20fixed_rate_bond_objects%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(%22No%20valid%20bonds%20for%20calibration%22)%0A%20%20%20%20%20%20%20%20param_bounds%20%3D%20%5B(1e-3%2C%200.1)%2C%20(-0.1%2C%200.1)%2C%20(-0.1%2C%200.1)%2C%20(1e-3%2C%2010)%5D%0A%20%20%20%20%20%20%20%20calib_results%20%3D%20cmt.minimize(nelson_siegel_sse_fixed%2C%20initial_nelson_siegel_params%2C%20args%20%3D%20(calc_date%2C%20fixed_rate_bond_objects%2C%20bond_market_prices%2C%20calib_weights%2C%20tsy_yield_curve_handle%2C%20bond_recovery_rate)%2C%20bounds%20%3D%20param_bounds)%0A%20%20%20%20%20%20%20%20return%20calib_results%2C%20valid_indices%0A%0A%20%20%20%20def%20calibrate_yield_curve_from_frame_stable(calc_date%2C%20treasury_details%2C%20price_quote_column)%3A%0A%20%20%20%20%20%20%20%20ql.Settings.instance().evaluationDate%20%3D%20calc_date%0A%20%20%20%20%20%20%20%20sorted_details_frame%20%3D%20treasury_details.sort_values(by%3D'maturity')%20%20%20%20%0A%20%20%20%20%20%20%20%20day_count%20%3D%20ql.ActualActual(ql.ActualActual.ISMA)%0A%20%20%20%20%20%20%20%20bond_helpers%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20index%2C%20row%20in%20sorted_details_frame.iterrows()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_object%20%3D%20cmt.create_bond_from_symbology(row)%0A%20%20%20%20%20%20%20%20%20%20%20%20tsy_clean_price_quote%20%3D%20row%5Bprice_quote_column%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20tsy_clean_price_handle%20%3D%20ql.QuoteHandle(ql.SimpleQuote(tsy_clean_price_quote))%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_helper%20%3D%20ql.BondHelper(tsy_clean_price_handle%2C%20bond_object)%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_helpers.append(bond_helper)%0A%20%20%20%20%20%20%20%20yield_curve%20%3D%20ql.PiecewiseFlatForward(calc_date%2C%20bond_helpers%2C%20day_count)%0A%20%20%20%20%20%20%20%20yield_curve.enableExtrapolation()%0A%20%20%20%20%20%20%20%20return%20yield_curve%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20calculate_nelson_siegel_model_prices_and_yields_fixed%2C%0A%20%20%20%20%20%20%20%20calibrate_nelson_siegel_model_fixed%2C%0A%20%20%20%20%20%20%20%20calibrate_yield_curve_from_frame_stable%2C%0A%20%20%20%20%20%20%20%20create_bonds_and_weights_fixed%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(calc_date%2C%20cmt%2C%20pd%2C%20ql)%3A%0A%20%20%20%20%23%20---%20Problem%202%20---%0A%20%20%20%20bond_symbology%20%3D%20pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam%2Fdata%2Fbond_symbology.xlsx')%0A%20%20%20%20bond_market_prices_eod%20%3D%20pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam%2Fdata%2Fbond_market_prices_eod.xlsx')%0A%20%20%20%20bond_market_prices_eod%5B'midPrice'%5D%20%3D%20(bond_market_prices_eod%5B'bidPrice'%5D%20%2B%20bond_market_prices_eod%5B'askPrice'%5D)%20%2F%202%0A%20%20%20%20bond_market_prices_eod%5B'midYield'%5D%20%3D%20(bond_market_prices_eod%5B'bidYield'%5D%20%2B%20bond_market_prices_eod%5B'askYield'%5D)%20%2F%202%0A%0A%20%20%20%20aapl_row%20%3D%20bond_symbology%5Bbond_symbology%5B'isin'%5D%20%3D%3D%20'US037833AT77'%5D.iloc%5B0%5D%0A%20%20%20%20aapl_bond%20%3D%20cmt.create_bond_from_symbology(aapl_row)%0A%20%20%20%20aapl_cashflows%20%3D%20cmt.get_bond_cashflows(aapl_bond%2C%20calc_date)%0A%0A%20%20%20%20aapl_market%20%3D%20bond_market_prices_eod%5Bbond_market_prices_eod%5B'isin'%5D%20%3D%3D%20'US037833AT77'%5D.iloc%5B0%5D%0A%20%20%20%20aapl_yield%20%3D%20aapl_market%5B'midYield'%5D%0A%20%20%20%20y%20%3D%20aapl_yield%20%2F%20100.0%0A%0A%20%20%20%20flat_rate%20%3D%20ql.SimpleQuote(y)%0A%20%20%20%20rate_handle%20%3D%20ql.QuoteHandle(flat_rate)%0A%20%20%20%20day_count%20%3D%20ql.Thirty360(ql.Thirty360.USA)%0A%20%20%20%20compounding%20%3D%20ql.Compounded%0A%20%20%20%20frequency%20%3D%20ql.Semiannual%0A%0A%20%20%20%20yield_ts%20%3D%20ql.FlatForward(calc_date%2C%20rate_handle%2C%20day_count%2C%20compounding%2C%20frequency)%0A%20%20%20%20engine%20%3D%20ql.DiscountingBondEngine(ql.YieldTermStructureHandle(yield_ts))%0A%20%20%20%20aapl_bond.setPricingEngine(engine)%0A%0A%20%20%20%20price%20%3D%20aapl_bond.cleanPrice()%0A%20%20%20%20interest_rate%20%3D%20ql.InterestRate(y%2C%20day_count%2C%20compounding%2C%20frequency)%0A%20%20%20%20mod_duration%20%3D%20ql.BondFunctions.duration(aapl_bond%2C%20interest_rate%2C%20ql.Duration.Modified)%0A%20%20%20%20convexity%20%3D%20ql.BondFunctions.convexity(aapl_bond%2C%20interest_rate)%0A%20%20%20%20dv01%20%3D%20mod_duration%20*%20price%20*%200.0001%0A%20%20%20%20return%20bond_market_prices_eod%2C%20bond_symbology%0A%0A%0A%40app.cell%0Adef%20_(calc_date%2C%20cmt%2C%20pd%2C%20ql)%3A%0A%20%20%20%20%23%20---%20Problem%203%20---%0A%20%20%20%20sofr_symbology%20%3D%20pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam%2Fdata%2Fsofr_swaps_symbology.xlsx')%0A%20%20%20%20sofr_market%20%3D%20pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam%2Fdata%2Fsofr_swaps_market_data_eod.xlsx')%0A%20%20%20%20sofr_df%20%3D%20pd.merge(sofr_market%2C%20sofr_symbology%2C%20on%3D'figi').drop_duplicates(subset%3D%5B'tenor'%5D)%0A%20%20%20%20sofr_curve%20%3D%20cmt.calibrate_sofr_curve_from_frame(calc_date%2C%20sofr_df%2C%20'midRate')%0A%20%20%20%20sofr_handle%20%3D%20ql.YieldTermStructureHandle(sofr_curve)%0A%0A%20%20%20%20cds_market%20%3D%20pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam%2Fdata%2Fcds_market_data_eod.xlsx')%0A%20%20%20%20ford_cds_row%20%3D%20cds_market%5Bcds_market%5B'ticker'%5D%20%3D%3D%20'F'%5D.iloc%5B0%5D%0A%20%20%20%20tenors_yrs%20%3D%20%5B1%2C%202%2C%203%2C%205%2C%207%2C%2010%5D%0A%20%20%20%20ford_spreads%20%3D%20%5Bford_cds_row%5Bf'par_spread_%7Bt%7Dy'%5D%20for%20t%20in%20tenors_yrs%5D%0A%0A%20%20%20%20ford_hazard_curve%20%3D%20cmt.calibrate_cds_hazard_rate_curve(calc_date%2C%20sofr_handle%2C%20ford_spreads)%0A%20%20%20%20ford_hazard_handle%20%3D%20ql.DefaultProbabilityTermStructureHandle(ford_hazard_curve)%0A%0A%20%20%20%20cds_coupon%20%3D%20100.0%20%2F%2010000.0%0A%20%20%20%20cds_maturity%20%3D%20ql.Date(20%2C%206%2C%202029)%0A%20%20%20%20notional%20%3D%2010000000.0%0A%20%20%20%20side%20%3D%20ql.Protection.Buyer%0A%20%20%20%20schedule%20%3D%20ql.MakeSchedule(effectiveDate%3Dcalc_date%2C%20terminationDate%3Dcds_maturity%2C%20tenor%3Dql.Period(3%2C%20ql.Months)%2C%20calendar%3Dql.UnitedStates(ql.UnitedStates.GovernmentBond)%2C%20convention%3Dql.Following%2C%20terminalDateConvention%3Dql.Unadjusted%2C%20rule%3Dql.DateGeneration.TwentiethIMM%2C%20endOfMonth%3DFalse)%0A%20%20%20%20cds_obj%20%3D%20ql.CreditDefaultSwap(side%2C%20notional%2C%20cds_coupon%2C%20schedule%2C%20ql.Following%2C%20ql.Actual360())%0A%20%20%20%20cds_engine%20%3D%20ql.MidPointCdsEngine(ford_hazard_handle%2C%200.4%2C%20sofr_handle)%0A%20%20%20%20cds_obj.setPricingEngine(cds_engine)%0A%0A%20%20%20%20cds_pv%20%3D%20cds_obj.NPV()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(calc_date%2C%20cmt%2C%20pd%2C%20ql)%3A%0A%20%20%20%20%23%20---%20Problem%205%20---%0A%20%20%20%20lqd_comp%20%3D%20pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam%2Fdata%2Flqd_basket_composition.xlsx')%0A%20%20%20%20lqd_symb%20%3D%20pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam%2Fdata%2Flqd_corp_symbology.xlsx')%0A%20%20%20%20lqd_merged%20%3D%20pd.merge(lqd_comp%2C%20lqd_symb%2C%20on%3D'isin'%2C%20how%3D'left')%0A%0A%20%20%20%20bond_dv01s%20%3D%20%5B%5D%0A%20%20%20%20basket_dv01s%20%3D%20%5B%5D%0A%0A%20%20%20%20for%20idx%2C%20row%20in%20lqd_merged.iterrows()%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20bond%20%3D%20cmt.create_bond_from_symbology(row)%0A%20%20%20%20%20%20%20%20%20%20%20%20y_5%20%3D%20row%5B'yield'%5D%20%2F%20100.0%0A%20%20%20%20%20%20%20%20%20%20%20%20dc%20%3D%20bond.dayCounter()%0A%20%20%20%20%20%20%20%20%20%20%20%20ir%20%3D%20ql.InterestRate(y_5%2C%20dc%2C%20ql.Compounded%2C%20ql.Semiannual)%0A%20%20%20%20%20%20%20%20%20%20%20%20price_5%20%3D%20bond.cleanPrice(y_5%2C%20dc%2C%20ql.Compounded%2C%20ql.Semiannual%2C%20calc_date)%0A%20%20%20%20%20%20%20%20%20%20%20%20mod_dur%20%3D%20ql.BondFunctions.duration(bond%2C%20ir%2C%20ql.Duration.Modified%2C%20calc_date)%0A%20%20%20%20%20%20%20%20%20%20%20%20b_dv01%20%3D%20price_5%20*%20mod_dur%20*%200.0001%0A%20%20%20%20%20%20%20%20%20%20%20%20basket_dv01%20%3D%20b_dv01%20*%20row%5B'face_notional'%5D%20%2F%20100.0%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_dv01s.append(b_dv01)%0A%20%20%20%20%20%20%20%20%20%20%20%20basket_dv01s.append(basket_dv01)%0A%20%20%20%20%20%20%20%20except%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20bond_dv01s.append(0)%0A%20%20%20%20%20%20%20%20%20%20%20%20basket_dv01s.append(0)%0A%0A%20%20%20%20lqd_merged%5B'bond_DV01'%5D%20%3D%20bond_dv01s%0A%20%20%20%20lqd_merged%5B'basket_DV01'%5D%20%3D%20basket_dv01s%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20as_of_date%2C%0A%20%20%20%20bond_market_prices_eod%2C%0A%20%20%20%20bond_symbology%2C%0A%20%20%20%20calc_date%2C%0A%20%20%20%20calculate_nelson_siegel_model_prices_and_yields_fixed%2C%0A%20%20%20%20calibrate_nelson_siegel_model_fixed%2C%0A%20%20%20%20calibrate_yield_curve_from_frame_stable%2C%0A%20%20%20%20create_bonds_and_weights_fixed%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20ql%2C%0A)%3A%0A%20%20%20%20%23%20---%20Problem%206%20---%0A%20%20%20%20govt_symb%20%3D%20pd.read_excel('UChicago_FINM_35700_CreditMarkets_Spring2024_FinalExam%2Fdata%2Fgovt_on_the_run.xlsx')%0A%20%20%20%20govt_symb_full%20%3D%20pd.merge(govt_symb%5B%5B'isin'%5D%5D%2C%20bond_symbology%2C%20on%3D'isin'%2C%20how%3D'left')%0A%20%20%20%20govt_merged%20%3D%20pd.merge(govt_symb_full%2C%20bond_market_prices_eod%5B%5B'isin'%2C%20'midPrice'%5D%5D%2C%20on%3D'isin')%0A%20%20%20%20tsy_curve%20%3D%20calibrate_yield_curve_from_frame_stable(calc_date%2C%20govt_merged%2C%20'midPrice')%0A%20%20%20%20tsy_handle%20%3D%20ql.YieldTermStructureHandle(tsy_curve)%0A%0A%20%20%20%20full_universe%20%3D%20pd.merge(bond_symbology%2C%20bond_market_prices_eod%2C%20on%3D'isin')%0A%20%20%20%20if%20'ticker_x'%20in%20full_universe.columns%3A%0A%20%20%20%20%20%20%20%20full_universe.rename(columns%3D%7B'ticker_x'%3A%20'ticker'%7D%2C%20inplace%3DTrue)%0A%0A%20%20%20%20orcl_bonds%20%3D%20full_universe%5B%0A%20%20%20%20%20%20%20%20(full_universe%5B'ticker'%5D%20%3D%3D%20'ORCL')%20%26%20%0A%20%20%20%20%20%20%20%20(full_universe%5B'cpn_type'%5D%20%3D%3D%20'FIXED')%20%26%20%0A%20%20%20%20%20%20%20%20(full_universe%5B'amt_out'%5D%20%3E%20100)%0A%20%20%20%20%5D.copy()%0A%0A%20%20%20%20if%20'class_x'%20in%20orcl_bonds.columns%3A%0A%20%20%20%20%20%20%20%20orcl_bonds.rename(columns%3D%7B'class_x'%3A%20'class'%7D%2C%20inplace%3DTrue)%0A%0A%20%20%20%20for%20col%20in%20%5B'days_settle'%2C%20'coupon'%2C%20'start_date'%2C%20'maturity'%2C%20'acc_first'%2C%20'cpn_freq'%5D%3A%0A%20%20%20%20%20%20%20%20if%20f'%7Bcol%7D_x'%20in%20orcl_bonds.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20orcl_bonds.rename(columns%3D%7Bf'%7Bcol%7D_x'%3A%20col%7D%2C%20inplace%3DTrue)%0A%0A%20%20%20%20orcl_bonds%5B'maturity_dt'%5D%20%3D%20pd.to_datetime(orcl_bonds%5B'maturity'%5D)%0A%20%20%20%20orcl_bonds%5B'TTM'%5D%20%3D%20(orcl_bonds%5B'maturity_dt'%5D%20-%20as_of_date).dt.days%20%2F%20365.25%0A%20%20%20%20orcl_bonds.sort_values('TTM'%2C%20inplace%3DTrue)%0A%0A%20%20%20%20init_params%20%3D%20%5B0.01%2C%200.01%2C%200.01%2C%201.0%5D%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20res%2C%20valid_indices%20%3D%20calibrate_nelson_siegel_model_fixed(init_params%2C%20calc_date%2C%20orcl_bonds%2C%20tsy_handle)%0A%20%20%20%20%20%20%20%20opt_params%20%3D%20res.x%0A%0A%20%20%20%20%20%20%20%20orcl_bonds_valid%20%3D%20orcl_bonds.loc%5Bvalid_indices%5D.copy()%0A%20%20%20%20%20%20%20%20fixed_bonds%2C%20weights%2C%20mkt_prices%2C%20mkt_yields%2C%20dv01s%2C%20durs%2C%20_%20%3D%20create_bonds_and_weights_fixed(orcl_bonds_valid%2C%20tsy_handle)%0A%20%20%20%20%20%20%20%20mod_prices%2C%20mod_yields%20%3D%20calculate_nelson_siegel_model_prices_and_yields_fixed(opt_params%2C%20calc_date%2C%20fixed_bonds%2C%20tsy_handle)%0A%0A%20%20%20%20%20%20%20%20orcl_bonds_valid%5B'modelPrice'%5D%20%3D%20mod_prices%0A%20%20%20%20%20%20%20%20orcl_bonds_valid%5B'modelYield'%5D%20%3D%20mod_yields%0A%0A%20%20%20%20%20%20%20%20print(%22NS%20Calibrated%22)%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20print(f%22NS%20Calibration%20Error%3A%20%7Be%7D%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">6391c3c9a8b8bb05de475383a0b7abc5</marimo-code-hash>
</body>
</html>
